---
title: 【TCP/IP详解】 第1章 概述
date: 2021-04-02 01:00:00
tags: 
  - 计算机网络
categories: 
- [计算机基础, 网络, TCP/IP详解 卷1]
---

《TCP/IP详解 卷1：协议》第1章笔记

<!--more-->

## 1.1 分层
**TCP/IP 协议族的四个层次**
![TCP/IP协议族的四个层次](TCP-IP协议族的四个层次.png)
  - 链路层，也称作数据链路层或网络接口层，通常包括操作系统中的设备驱动程序和计算机中对应的网络接口卡，一起处理与电缆（或其他任何传输媒介）的物理接口细节。
  - 网络层，也称互联网层，提供**点到点**的服务，处理分组在网络中的活动。（**不可靠**的服务。）
  - 运输层，主要为两台主机提供**端到端**的通信。TCP 在 不可靠的 IP层上提供了**可靠**的运输层。
  - 应用层，负责处理特定的应用程序细节。

<br>

**路由器**
  - 构造互联网的共同基石是路由器。
  - 构造互连网最简单的方法是把两个或多个网络通过路由器连接。路由器具有多个网络接口，通常连接不同网络的接口有不同的 MAC 地址。
  - 路由器是在网络层上对网络进行互连，网桥是在链路层上对网络进行互连。

![通过路由器连接的两个网络](通过路由器连接的两个网络.png)

## 1.2 TCP/IP的分层
![TCP/IP协议族中不同层次的协议](TCP-IP协议族中不同层次的协议.png)
- TCP 和 UDP 都是用 IP 作为网络层协议
- TCP 虽然使用不可靠的 IP 服务，但它提供一种可靠的运输层服务。
- UDP 提供不可靠服务。SNMP 使用UDP 协议。
- TCP 和 UDP 的每组数据都通过端系统和每个中间路由器中的 IP 层在互连网中进行传播。
- ICMP 是 IP 协议的附属协议，用它来与其他主机或路由器交换错误报文和其他重要信息，Ping 和 Traceroute 都使用 ICMP。
- IGMP 是 Internet 组管理协议，用来把一个 UDP 数据包多播到多个主机。
- ARP 和 RARP 是某些网络接口使用的特殊协议，用来转换 IP 层和网络接口层使用的地址。

## 1.3 互连网的地址
互联网上的每个接口必须有一个唯一的 Internet 地址。IPv4 长32位，IPv6 长128位。本书中提到的 IP 地址都是 IPv4。
![五类互联网地址](五类互联网地址.png)
![各类IP地址的范围](各类IP地址的范围.png)

## 1.4 域名系统（DNS）
域名系统是一个分布式数据库，，它提供 IP 地址与主机名之间的映射信息。

## 1.5 封装
![数据进入协议栈时的封装过程](数据进入协议栈时的封装过程.png)
- 运输层
   - TCP 报文段：TCP 是有连接的，每个需传输的 TCP 数据单元都是应用程序总传输数据的一部分（段），它们存在着先后顺序，而不是单独的。
   - UDP 数据报：UDP 是无连接的，每个数据报是独立的，不属于某个整体，和 IP 数据报一样。首部 8 字节。
- 网络层：IP 数据报
- 链路层：帧(Frame)，以太网传输。 

## 1.6 分用
当目的主机收到一个以太网数据帧时，数据就开始从协议栈中由底向上升，同时去掉各层协议加上的报文首部。每层协议盒都要去检查报文首部中的协议标识，以确定接收数据的上层协议，这个过程称作分用。
![以太网数据帧的分用过程](以太网数据帧的分用过程.png)
- ICMP 和 IGMP 报文都被封装在 IP 数据报中。

## 1.7 端口号
- 端口号用来标识互相通信的应用程序。
- 服务器使用知名端口号。
- 客户端通常对它所使用的端口号并不关心，只要保证该端口号在本机上唯一，使用临时端口号。